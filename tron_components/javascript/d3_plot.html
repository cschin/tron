<script id="d3_lib" async src="https://d3js.org/d3.v6.js"></script>
<script> // for d3 plot
  function get_event_with_coordinate(event) {
    if (event == null || event.type == "load") { // htxm may evaluate "load" event that does not has "getAttribute" 
      return
    } else {
      const rect = event.currentTarget.getBoundingClientRect();
      const svg = document.querySelector("#"+event.currentTarget.id+'> svg');
      const [e_x, e_y] = d3.pointer(event, svg);
      return {
        "tn_event":
        {
          "e_trigger": event.currentTarget.id,
          "e_type": event.type,
          "e_state": event.currentTarget.getAttribute('state'),
          "e_target": event.currentTarget.getAttribute('hx-target')
        },
        "e_x": e_x,
        "e_y": e_y
      };
    };
  };
</script>
